<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!--<style>-->
<!--    html, body {-->
<!--        width: 100%; height: 100%;-->
<!--    }-->
<!--</style>-->


<header>
<!--    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>-->
    <title>MAP4BASE</title>
    <script>
        var realeItems;
        //var container;
        var map;
        //var infowindow;
        //var zoomControl;
        //var moveLatLon;
    </script>
<!--    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">-->
<!--    <link rel="stylesheet" href="/resources/demos/style.css">-->

<!--    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>-->
<!--    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>-->
<!--    <script-->
<!--            src="https://code.jquery.com/jquery-3.6.1.min.js"-->
<!--            integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="-->
<!--            crossorigin="anonymous"></script>-->
<!--    <script-->
<!--            src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"-->
<!--            integrity="sha256-eTyxS0rkjpLEo16uXTS0uVCS4815lc40K2iVpWDvdSY="-->
<!--            crossorigin="anonymous"></script>-->

<!--    <style type="text/css">-->
    <style>

        #searchbar{
            width: fit-content;
            height: 45px;
            background-color: #e5c7ca;
            /*font-size: small;*/
            /*align-content: center;*/
            /*align-items: center;*/

            /*display: flex;*/
            /*align-items: center;*/
            /*justify-content: center;*/
        }


        /*.ui-button ui-widget ui-corner-all{*/
        /*    text-align: center;*/
        /*}*/

        #sheetlink{
            width: 220px;
            height: 45px;
            float: left;
            /*font-size: medium;*/
            /*text-align: center;*/
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #searchbtn {
            width: 100px;
            height: 45px;
            background-color: #e5c7ca;
            float: left;
            /*text-align: center;*/
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #search1{
            width: 350px;
            height: 45px;
            background-color: whitesmoke;
            float: left;
            font-size: small;
        }
        #search2{
            width: 220px;
            height: 45px;
            background-color: whitesmoke;
            float: left;
            font-size: small;
        }
        #search3{
            width: 220px;
            height: 45px;
            background-color: whitesmoke;
            float: left;
            font-size: small;
        }

        #searchspace0, #searchspace1, #searchspace2, #searchspace3 {width: 20px;height: 45px;background-color: #e5c7ca;float: left;}

    </style>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <script>
        function commaCheck(value){
            value = value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return value;
        }

        $( function() {
            $( "#slider-amountall" ).slider({
                range: true,
                min: 0,
                max: 5000000000,
                step: 1000000,
                values: [ 0, 1000000000 ],
                slide: function( event, ui ) {
                    $( "#amountall" ).val( "" + commaCheck(ui.values[ 0 ]) + " ~ " + commaCheck(ui.values[ 1 ] + " 원") );
                }
            });
            // $( "#amountall" ).val( "" + $( "#slider-amountall" ).slider("values", 0) +
            //      " ~ " + $( "#slider-amountall" ).slider("values", 1)  + " 원" )  ;
            $( "#amountall" ).val("0 ~ 1,000,000,000" + " 원" ) ;
            //$( "#amountall" ).val(ui.values[0] + " ~ " + ui.values[1] + " 원" ) ;
            //$( "#amountall" ).val( "" + values[ 0 ] + " ~ " + values[ 1 ] + " 원" );
        } );

        $( function() {
            $( "#slider-amountunit" ).slider({
                range: true,
                min: 0,
                max: 30000000,
                values: [ 0, 30000000 ],
                slide: function( event, ui ) {
                    $( "#amountunit" ).val( "" + commaCheck(ui.values[ 0 ]) + " - " + commaCheck(ui.values[ 1 ]) + " 원");
                }
            });
            // $( "#amountunit" ).val( "￦" + $( "#slider-amountunit" ).slider( "values", 0 ) +
            //     " - ￦" + $( "#slider-amountunit" ).slider( "values", 1 ) );
            $( "#amountunit" ).val("0 ~ 30,000,000" + " 원" ) ;
        } );

        $( function() {
            $( "#slider-size" ).slider({
                range: true,
                min: 0,
                max: 10000,
                values: [ 0, 1000 ],
                slide: function( event, ui ) {
                    $( "#size" ).val( "" + commaCheck(ui.values[ 0 ]) + " - " + commaCheck(ui.values[ 1 ]) + " 평" );
                }
            });
            //$( "#size" ).val( "평" + $( "#slider-size" ).slider( "values", 0 ) +
            //    " - 평" + $( "#slider-size" ).slider( "values", 1 ) );
            $( "#size" ).val("0 ~ 1,000" + " 평" ) ;
        } );


        $( function() {
            // $( ".widget input[type=submit], .widget a, .widget button" ).button();
            // $( "input, a" ).on( "click", function( event ) {
            //     event.preventDefault();
            //     //alert('clicked input a');
            // } );
            $( "button" ).on( "click", function( event ) {
                event.preventDefault();
                //alert('clicked button');
                //var value11 = $( ".selector" ).slider( "values", 0 );



                var amountall_min = $( "#slider-amountall" ).slider( "values", 0 );
                var amountall_max = $( "#slider-amountall" ).slider( "values", 1 );

                var amountunit_min = $( "#slider-amountunit" ).slider( "values", 0 );
                var amountunit_max = $( "#slider-amountunit" ).slider( "values", 1 );

                var size_min = $( "#slider-size" ).slider( "values", 0 );
                var size_max = $( "#slider-size" ).slider( "values", 1 );


                alert("value11 : " + amountall_min + " " + amountall_max + " " + amountunit_min + " " + amountunit_max + " " + size_min + " " + size_max);
                //ui.values[ 0 ]
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                //   Search 버튼 클릭 이벤트 발생 시  realeItems에서 총금액, 평단가, 토지평수로 필터링하여 filteredItems 만들어서 지도에 뿌린다. //
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                console.log(realeItems);
                // let filteredItems = realeItems.filter( (realeItem) => {
                //     return realeItem.addrName === "서귀포시 토평동"
                // });
                let filteredItems = realeItems.filter( (realeItem) => {
                    return realeItem.amt * 1000000 >= amountall_min && realeItem.amt * 1000000 <= amountall_max
                });
                filteredItems = filteredItems.filter( (filteredItem) => {
                    return filteredItem.dang * 1000000 >= amountunit_min && filteredItem.dang * 1000000 <= amountunit_max
                });

                filteredItems = filteredItems.filter( (filteredItem) => {
                    return filteredItem.py >= size_min && filteredItem.py <= size_max
                });

                // filteredItems = filteredItems.filter( (filteredItem) => {
                //     return filteredItem.dang >= 1 && filteredItem.dang <= 3
                // });
                //
                // filteredItems = filteredItems.filter( (filteredItem) => {
                //     return filteredItem.py >= 300 && filteredItem.py <= 380
                // });
                console.log(filteredItems);
                map.relayout();
                display_kakaomap_options(filteredItems);
            } );
        } );



    </script>
</header>

<body>
<!--<script> var realeItems; </script> 있던자리-->
<!--    <script> var userlevel = "admin"; </script>-->
<script> var userlevel = "user";
var sheetlinkurl = "";
var sheetlinkhttp = "";

</script>
<th:block th:replace="~{/layout/basic :: setContent(~{this::content} )}">

    <th:block th:fragment="content">

        <script th:inline="javascript">

            // var positions = [
            //     {   title: '동홍동 633 창고용지',
            //         latlng: new daum.maps.LatLng(33.2605331,126.571985,15)
            //     }
            //     ,{  title: '<div style="padding:5px;"> 강정동 4070-2  평OOO 금액OOO 지목OOO <br> <a href="https://map.kakao.com/link/map ,33.2522565,126.4815181" style="color:blue" target="_blank">큰지도보기</a> </div>',
            //         latlng: new daum.maps.LatLng(33.2522565,126.4815181,15)
            //     }
            //     // ,{  title: '강정동 4070-2 <div style="padding:5px;">평OOO 금액OOO 지목OOO <br> <a href="https://map.kakao.com/link/map/강정동4070-2 ,33.2522565,126.4815181" style="color:blue" target="_blank">큰지도보기</a> <a href="https://map.kakao.com/link/to/강정동4070-2,33.2522565,126.4815181" style="color:blue" target="_blank">길찾기</a></div>',
            //     //     latlng: new daum.maps.LatLng(33.2522565,126.4815181,15)
            //     // }
            //
            // ];

            realeItems = [[${realeItems}]];
            //console.log(realeItems);
            //console.log(realeItems[0].addrName);
            //console.log(realeItems[1]);
            //console.log(realeItems[2]);

        </script>



        <!--pagename을 sheetlink로 통합시켰음-->
        <!--<div id="pagename" style="z-index:6;position:absolute;"></div>-->


<!--        <div id="funbtn" style="z-index:5;position:absolute;">-->
            <!--                <button onclick="setOverlayMapTypeId('traffic')">교통정보 보기</button>-->
<!--            <button onclick="setOverlayMapTypeId('roadview')">로드뷰 도로정보 보기</button>-->
<!--            <button style="font-size:0.9em;padding:5px;border:1px;border-top-left-radius:15px;border-bottom-left-radius:15px" onclick="setOverlayMapTypeId('terrain')">지형도</button>-->
<!--            <button style="font-size:0.9em;padding:5px;border:1px;border-top-right-radius:15px;border-bottom-right-radius:15px" onclick="setOverlayMapTypeId('use_district')">지적도</button>-->
<!--            <button style="font-size:0.9em;padding:5px;border:1px;border-top-left-radius:15px;border-bottom-left-radius:15px" onclick="setOverlayMapTypeId('skyview')">제거</button>-->
<!--        </div>-->


<!--        <div id="text1">안녕하세요</div>-->
<!--        <script>-->
<!--            $('#text1').html();-->
<!--            $('#text1').html('여기다');-->
<!--            $('#text1').text('여기다text');-->
<!--            $('#text1').css('color', 'red');-->
<!--            $('#text1').attr('src','aaa.jpg');-->
<!--        </script>-->

        <div id="searchbar">


            <!--            <div id="sheetlink" style="z-index:6;position:absolute;"></div>-->
            <div id="sheetlink" > </div>

            <div id="searchbtn">
<!--                <a class="ui-button ui-widget ui-corner-all" href="#">Search</a>-->
                <!--        <div class="widget">-->
                <!--            <h1>Widget Buttons</h1>-->
                            <button>Search</button>
                <!--            <input type="submit" value="A submit button">-->
                <!--            <a href="#">search</a>-->
                <!--        </div>-->
            </div>

            <div id="searchspace0"></div>

            <div id="search1">
                <p>
                    <label for="amountall">총금액:</label>
                    <input type="text" id="amountall" readonly style="border:0; color:#f6931f; font-weight:bold; width: 280px">
                </p>
                <div id="slider-amountall"></div>
            </div>
            <div id="searchspace1"></div>

            <div id="search2">
                <p>
                    <label for="amountunit">평단가:</label>
                    <input type="text" id="amountunit" readonly style="border:0; color:#f6931f; font-weight:bold;">
                </p>
                <div id="slider-amountunit"></div>
            </div>
            <div id="searchspace2"></div>

            <div id="search3" >
                <p>
                    <label for="size">토지평수:</label>
                    <input type="text" id="size" readonly style="border:0; color:#f6931f; font-weight:bold; width: 120px">
                </p>
                <div id="slider-size"></div>
            </div>
            <div id="searchspace3"></div>
        </div>



        <script>
            function getLocationlatlng(addrFullName){

                var lat = "";
                var lng = "";
                var addressName = "";
                console.log("call URL : " + 'https://dapi.kakao.com/v2/local/search/address.json?query='+encodeURIComponent(addrFullName));
                $.ajax({
                    url: 'https://dapi.kakao.com/v2/local/search/address.json?query=' + encodeURIComponent(addrFullName),
                    headers: {'Authorization': 'KakaoAK 8e088f3d4fbfb59348444dae045d34c2'},
                    async: false,
                    type: 'GET'
                }).done(function(data){

                    addressName = data.documents[0].address_name;
                    lng = data.documents[0].x;
                    lat = data.documents[0].y;
                    console.log("addressName_f : " + addressName);
                    console.log("lat_f : " + lat);
                    console.log("lng_f : " + lng);


                });

                return [lat, lng, addressName];

            }


            // 지도에 추가된 지도타입정보를 가지고 있을 변수입니다
            var currentTypeId;
            function setOverlayMapTypeId(maptype) {
                var changeMaptype;

                // maptype에 따라 지도에 추가할 지도타입을 결정합니다
                if (maptype === 'traffic') {

                    // 교통정보 지도타입
                    changeMaptype = kakao.maps.MapTypeId.TRAFFIC;

                } else if (maptype === 'roadview') {

                    // 로드뷰 도로정보 지도타입
                    changeMaptype = kakao.maps.MapTypeId.ROADVIEW;

                } else if (maptype === 'terrain') {

                    // 지형정보 지도타입
                    changeMaptype = kakao.maps.MapTypeId.TERRAIN;

                } else if (maptype === 'use_district') {

                    // 지적편집도 지도타입
                    changeMaptype = kakao.maps.MapTypeId.USE_DISTRICT;
                }

                // 이미 등록된 지도 타입이 있으면 제거합니다
                if (currentTypeId) {
                    map.removeOverlayMapTypeId(currentTypeId);
                }

                // maptype에 해당하는 지도타입을 지도에 추가합니다
                map.addOverlayMapTypeId(changeMaptype);

                // 지도에 추가된 타입정보를 갱신합니다
                currentTypeId = changeMaptype;
            }




            // 인포윈도우를 표시하는 클로저를 만드는 함수입니다
            function makeOverListener(map, marker, infowindow) {
                return function() {
                    infowindow.open(map, marker);
                };
            }

            // 인포윈도우를 닫는 클로저를 만드는 함수입니다
            function makeOutListener(infowindow) {
                return function() {
                    infowindow.close();
                };
            }

        </script>


        <div id="map" style="z-index:1;position:relative;width:100%;height:100vh;"></div>


        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=5d544f32a8e4412eaf361e092cdf5d1f&libraries=services"></script>

        <script>


            function display_kakaomap_options(filteredItems) {


                //var container = null;
                //container = null;

                var container =  document.getElementById('map');

                var options = {
                    center: new kakao.maps.LatLng(33.245680186918, 126.56193465796456),
                    level: 5
                };

                //var map = new kakao.maps.Map(container, options);
                map = null;
                map = new kakao.maps.Map(container, options);


                //뷰타입 초기값 세팅
                //baseType 으로 스카이뷰 부터 깔고
                map.addOverlayMapTypeId(kakao.maps.MapTypeId.SKYVIEW);
                //overayType 으로 지적편집도 오버레이시킴
                map.addOverlayMapTypeId(kakao.maps.MapTypeId.USE_DISTRICT);


                // 일반 지도와 스카이뷰로 지도 타입을 전환할 수 있는 지도타입 컨트롤을 생성합니다
                // 아래 토글 컨트롤은 안먹혀서 일단 주석처리함 map.addOverlayMapTypeId(kakao.maps.MapTypeId.SKYVIEW);셋팅하니까 안먹히네
                //var mapTypeControl = new kakao.maps.MapTypeControl();
                //map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);

                // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
                var zoomControl = new kakao.maps.ZoomControl();
                map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

                //setCenter();


                console.log("다중마커 정보처리");
                //20220528 주소를 이용하여 다중 마커와 다중 인포윈도우 표시하기(Kakao 지도 API)
                //출처: https://bhpark.tistory.com/194 [Let's Study Animal Breeding:티스토리]
                // var listData = [
                //     ["제주특별자치도 서귀포시 강정동 4070-2","강정동 4070-2"],
                //     ["제주특별자치도 서귀포시 동홍동 633","동홍동 633"]
                // ];


                var geocoder = new daum.maps.services.Geocoder();

                //console.log("filteredItems 여기서도 참조되나?");
                console.log(filteredItems);

                var rownum = 1;
                // foreach loop
                // listData.forEach(function(addr, index) {
                filteredItems.forEach(function (addr, index) {

                    //물건ITEM이 여러개라도 선택된 MENU 명을 딱 한번만 표기함
                    if (rownum == 1) {


                        if (addr.pageName == "매매_접수중토지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1714268142" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_접수중토지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1714268142";
                        } else if (addr.pageName == "매매_건축할토지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=961118676" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_건축할토지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=961118676"
                        } else if (addr.pageName == "매매_농사할토지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1779157279" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_농사할토지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1779157279";
                        } else if (addr.pageName == "매매_맹지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1876251541" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_맹지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1876251541";
                        } else if (addr.pageName == "매매_주택") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1140087293" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_주택</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1140087293";
                        } else if (addr.pageName == "매매_공동주택") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=735473905" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_공동주택</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=735473905";
                        } else if (addr.pageName == "매매_상가주택") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=256417931" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">매매_상가주택</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=256417931";
                        } else if (addr.pageName == "임대차_상가점포") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=110267819" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">임대차_상가점포</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=110267819";
                        } else if (addr.pageName == "전세_주거") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=256385118" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">전세_주거</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=256385118";
                        } else if (addr.pageName == "년월세_주거") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=73370049" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">년월세_주거</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=73370049";
                        } else if (addr.pageName == "완료매매_건축할토지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1898269064" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료매매_건축할토지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1898269064";
                        } else if (addr.pageName == "완료매매_농사할토지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1975904288" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료매매_농사할토지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1975904288";
                        } else if (addr.pageName == "완료매매_맹지") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1140237127" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료매매_맹지</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1140237127";
                        } else if (addr.pageName == "완료매매_주택") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1478680808" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료매매_주택</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1478680808";
                        } else if (addr.pageName == "완료매매_공동주택") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=894709370" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료매매_공동주택</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=894709370";
                        } else if (addr.pageName == "완료매매_상가주택") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1441645393" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료매매_상가주택</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1441645393";
                        } else if (addr.pageName == "완료임대차_상가점포") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1924117688" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료임대차_상가점포</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1924117688";
                        } else if (addr.pageName == "완료전세_주거") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=385891742" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료전세_주거</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=385891742";
                        } else if (addr.pageName == "완료년월세_주거") {
                            sheetlinkurl = '<a href="https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1052034159" style="color:white;font-size:1.5em;text-decoration-line:none" target="_blank">완료년월세_주거</a>'
                            sheetlinkhttp = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=1052034159";
                        }

                        //$("#pagename").text(addr.pageName);
                        //console.log("pagename 표기 : " + addr.pageName);

                        $("#sheetlink").html(sheetlinkurl);

                    }

                    //console.log("addr.addrName.substr(1, 3) : " + addr.addrName.substr(0, 3));
                    if (addr.addrName.substr(0, 3) == "제주시") {
                        // console.log("addr.addrName.substr(1, 3) : " + addr.addrName.substr(1, 3));
                        // console.log("lat : " + latlng[0]);
                    } else {
                        addr.addrName = "서귀포시 " + addr.addrName;
                    }

                    var latlng = getLocationlatlng(addr.addrName + " " + addr.addrName2);
                    console.log("lat : " + latlng[0]);
                    console.log("lat : " + latlng[1]);
                    console.log("addressname : " + latlng[2]);

                    console.log("addr.addName2 : " + addr.addrName);
                    console.log("addr.addName2 : " + addr.addrName2);
                    console.log("addr.addName3 : " + addr.addrName3);
                    console.log("addr.rowIdx : " + addr.rowIdx);
                    console.log("addr.pnuCode : " + addr.pnuCode);

                    //addr.addName2 = (typeof addr.addName2 == 'undefined')? "" : addr.addName2;

                    var marker = new daum.maps.Marker({
                        map: map, // 마커를 표시할 지도
                        //position: new daum.maps.LatLng(33.2605331, 126.571985, 15), // 마커를 표시할 위치
                        position: new daum.maps.LatLng(Number(latlng[0]), Number(latlng[1]), 5), // 마커를 표시할 위치
                        title: String(latlng[2])
                    });

                    // 20220612 javascript에서 googlesheet query 쓰려다가 javacode로 처리하기로함
                    // var DATA_SOURCE_URL = "https://docs.google.com/spreadsheets/d/1ZnpywI0OLrYBWuiGnvalp3oFoNBVc81XOKQMVtDBvkg/edit#gid=193089992";
                    // var query = new google.visualization.Query(DATA_SOURCE_URL);
                    // query.setQuery('select A where  A = 5011010100');
                    // query.send(handleQueryResponse);


                    // 마커에 표시할 인포윈도우를 생성합니다
                    var overinfowindow = new kakao.maps.InfoWindow({
                        //content: positions[i].content // 인포윈도우에 표시할 내용
                        content: '<div style="padding:2px;font-size:0.8em">' + addr.addrName + " " + addr.addrName2 + ' ,' + addr.addrName3 + '</div>'
                    });
                    // 마커에 mouseover 이벤트와 mouseout 이벤트를 등록합니다
                    // 이벤트 리스너로는 클로저를 만들어 등록합니다
                    // for문에서 클로저를 만들어 주지 않으면 마지막 마커에만 이벤트가 등록됩니다
                    kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, overinfowindow));
                    kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(overinfowindow));


                    var color_amt = "black";
                    if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(200.00)) {        //빨
                        color_amt = "#FF0000";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(350.00)) {  //주
                        color_amt = "#FF7F50";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(500.00)) {  //노
                        color_amt = "#FFC300";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(700.00)) {  //초
                        color_amt = "#008000";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(1000.00)) {  //파
                        color_amt = "#0070FF";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(2000.00)) {  //남
                        color_amt = "#0008FF";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(3000.00)) {  //보
                        color_amt = "#AC42C1";
                    } else if (parseFloat(addr.amt.replace(',', '')) <= parseFloat(9000.00)) {  //보
                        color_dang = "#FF00FF";
                    }

                    var color_dang = "black";
                    if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(0.40)) { //빨
                        color_dang = "#FF0000";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(0.60)) { //주
                        color_dang = "#FF7F50";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(1.20)) { //노
                        color_dang = "#FFC300";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(1.80)) { //초
                        color_dang = "#008000";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(2.50)) { //파
                        color_dang = "#0070FF";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(3.20)) { //남
                        color_dang = "#0008FF";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(5.00)) { //보
                        color_dang = "#AC42C1";
                    } else if (parseFloat(addr.dang.replace(',', '')) <= parseFloat(90.00)) { //보
                        color_dang = "#FF00FF";
                    }


                    var dang2_yn = "";
                    if (addr.dang2 > 0.01) { //당2가 있으면 , 표기
                        dang2_yn = ",";
                    }


                    if (userlevel == "admin") {
                        var iwContent = '<div style="padding:2px;font-size:0.8em">' + addr.addrName + " " + addr.addrName2 + ' ,' + addr.addrName3 + ''
                                + '<br>' + addr.title
                                + '<br>' + addr.py + '평 ' + addr.category + ' ' + addr.zone
                                + '<br>' + addr.amt + '(' + addr.dang + ')'
                                + '<br>' + addr.amt2 + '(' + addr.dang2 + ')'
                                + '<br>' + '<a href="http://www.eum.go.kr/web/mp/mpMapDet.jsp?sId=selectaddr&pnu=' + addr.pnuCode + '" style="color:blue" target="_blank">' + 'eum' + '(' + addr.pnuCode.length + ')' + '</a>'
                                + '&nbsp' + '<a href="' + addr.link1 + '" style="color:blue" target="_blank">' + 'dis' + '(' + addr.link1.length + ')' + '</a>'
                                + '<br>' + addr.ads
                                + '<br>' + addr.explain
                                + '<br>' + addr.evaluation
                                + '<br>' + addr.regDate
                                + '</div>',
                            iwPosition = new daum.maps.LatLng(Number(latlng[0]), Number(latlng[1])); //인포윈도우 표시 위치입니다
                        //iwPosition = new daum.maps.LatLng(positions[i].latlng); //인포윈도우 표시 위치입니다
                    } else {
                        var addrfullname = addr.addrName.replace(" ", "").trim() + "" + addr.addrName2;
                        console.log("addrfullname : " + addrfullname);
                        //var iwContent = '<div style="padding:2px;font-size:0.8em">' + addr.addrName + " " + addr.addrName2 + ' ,' + addr.addrName3 + ''

                        var iwContent = ''
                                //타이틀 지역 지목 평 제곱미터 총가격 당가격
                                + '<div style="padding:0.2px;font-size:0.8em">'
                                + addr.title + '<br>' + addr.zone + ' ' + addr.category + ' ' + addr.py + '평' + '(' + addr.smeter + '㎡ )' + '</div>'
                                + '<div style="padding:0.0px;font-size:0.7em;float:left;with:50%;color:' + color_amt + '">' + addr.amt + '</div>' + '<div style="padding:0.0px;font-size:0.7em;float:left;with:50%;color:' + color_dang + '">' + '￦' + addr.dang + ' ' + dang2_yn + '</div>'

                                //설명부분
                                + '<br>' + '<div style="padding:0.0px;font-size:0.7em">' + addr.explain + '</div>'


                                //토지이음링크, 디스코링크, 네이버맵링크, 다음맵링크, 학구도링크
                                + '&nbsp' + '<a href=http://www.eum.go.kr/web/mp/mpMapDet.jsp?sId=selectaddr&pnu=' + addr.pnuCode + ' style="padding:0.2px;font-size:0.7em;color:blue" target="_blank">' + 'eum' + '(' + addr.pnuCode.length + ')' + '</a>'
                                + '&nbsp' + '<a href="' + addr.link1 + '" style="padding:0.2px;font-size:0.7em;color:blue" target="_blank">' + 'dis' + '(' + addr.link1.length + ')' + '</a>'
                                + '&nbsp' + '<a href=https://map.naver.com/v5/search/' + addrfullname + ' style="padding:0.2px;font-size:0.7em;color:blue" target="_blank">' + 'nmap' + '</a>'
                                + '&nbsp' + '<a href=https://map.kakao.com/?q=' + addrfullname + ' style="padding:0.2px;font-size:0.7em;color:blue" target="_blank">' + 'kmap' + '</a>'
                                + '&nbsp' + '<a href=https://schoolzone.emac.kr/gis/gis.do?schzonePage=1&searchText=' + addrfullname + ' style="padding:0.2px;font-size:0.5em;color:blue" target="_blank">' + '학' + '</a>'



                                //+ '' + addr.ads + ' idx' + addr.rowIdx   ads 에 광고등록했는지와 Idx를 한번에 넣어놓았음 GSheetRealeLand.java에 코딩
                                //오우너20%, 광고와인덱스번호50%, 해당시트의셀로가기15%, 광고문구및상세정보팝업15%
                                + '<br>' + '<div style="padding:0.0px;float:left;with:10%;font-size:0.5em">' + addr.owner.substr(0, 1) + "" + addr.owner.substr(addr.owner.length - 1, 1) + '</div>'
                                + addr.ads
                                + '&nbsp' + '<a href=' + sheetlinkhttp + '&range=A' + addr.rowIdx + ' style="padding:0.2px;font-size:0.7em;float:left;with:25%;color:blue" target="_blank">' + '&nbspgosh&nbsp' + '</a>'
                                + '&nbsp' + '<a href="/guestbook/infopopup?idx=' + addr.rowIdx + '&pageName=' + addr.pageName + '" style="padding:0.2px;font-size:0.7em;float:left;with:25%;color:blue" target="_blank">' + '&nbspinfo' + '</a>'
                            //+ '&nbsp' + '<a href="/guestbook/infopopup?idx=' + addr.rowIdx + '" style="padding:0.2px;font-size:0.7em;float:left;with:15%;color:blue" target="_blank">' + '_info' + '</a>'
                            ,
                            iwPosition = new daum.maps.LatLng(Number(latlng[0]), Number(latlng[1])); //인포윈도우 표시 위치입니다


                        // var cast = {
                        //     "idx" : "idx" + rownum,
                        //     "addr" : addr.addrName + " " + addr.addrName2 + ' ,' + addr.addrName3 + '',
                        //     "생년월일" : "2002",
                        //     "취미" : "농구",
                        //     "폰번호" : "0101100203",
                        //     "기타" : "~~"
                        // };

                        // Json Object를 저장하기

                        localStorage.setItem("realeItem" + rownum, JSON.stringify(realeItems[rownum - 1]));
                        //출처: https://kgu0724.tistory.com/229 [병아리 개발자의 이야기:티스토리]

                        //iwPosition = new daum.maps.LatLng(positions[i].latlng); //인포윈도우 표시 위치입니다
                    }


                    // 인포윈도우를 생성합니다
                    //infowindow = null;
                    //infowindow = new daum.maps.InfoWindow({
                    var infowindow = new daum.maps.InfoWindow({
                        position: iwPosition,
                        content: iwContent
                    });

                    // 마커 위에 인포윈도우를 표시합니다. 두번째 파라미터인 marker를 넣어주지 않으면 지도 위에 표시됩니다
                    infowindow.open(map, marker);


                    rownum++;
                });



                //주소검색 API    출처: https://mine-it-record.tistory.com/328 [나만의 기록들:티스토리]
                //https://developers.kakao.com/docs/latest/ko/local/dev-guide#address-coord
                // 결과 후처리 레퍼런스 사이트 https://developers.kakao.com/tool/rest-api/open/get/v2-local-search-address.%7Bformat%7D


                // function getLocationlatlng(addrFullName) 있던자리
                // function setCenterfn() {
                //     // 이동할 위도 경도 위치를 생성합니다
                //     //var moveLatLon = new kakao.maps.LatLng(33.245680186918, 126.56193465796456);
                //     var moveLatLon = new kakao.maps.LatLng(33.2647, 126.585);
                //
                //     // 지도 중심을 이동 시킵니다
                //     map.setCenter(moveLatLon);
                // }


                //센터로 위치시키기
                var moveLatLon = new kakao.maps.LatLng(33.2647, 126.585);
                //moveLatLon = new kakao.maps.LatLng(33.2647, 126.585);
                map.setCenter(moveLatLon);


            }


            display_kakaomap_options(realeItems);


            //display_kakaomap();


        </script>
    </th:block>
</th:block>





</body>
</html>

